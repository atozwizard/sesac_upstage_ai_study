25 Upstage 
클라우드 배포자동화-2 
SPEAKER 
서영학 © 2025 Upstage Co., Ltd. 
2 저작권 안내 
 
(주)업스테이지가 제공하는 모든 교육 콘텐츠의 지식재산권은 
운영 주체인 (주)업스테이지 또는 해당 저작물의 적법한 관리자에게 귀속되어 있습니다. 
콘텐츠 일부 또는 전부를 복사, 복제, 판매, 재판매 공개, 공유 등을 할 수 없습니다. 
유출될 경우 지식재산권 침해에 대한 책임을 부담할 수 있습니다. 
유출에 해당하여 금지되는 행위의 예시는 다음과 같습니다. 
● 콘텐츠를 재가공하여 온/오프라인으로 공개하는 행위 
● 콘텐츠의 일부 또는 전부를 이용하여 인쇄물을 만드는 행위 
● 콘텐츠의 전부 또는 일부를 녹취 또는 녹화하거나 녹취록을 작성하는 행위 
● 콘텐츠의 전부 또는 일부를 스크린 캡쳐하거나 카메라로 촬영하는 행위 
● 지인을 포함한 제3자에게 콘텐츠의 일부 또는 전부를 공유하는 행위 
● 다른 정보와 결합하여 Upstage Education의 콘텐츠임을 알아볼 수 있는 저작물을 작성, 공개하는 행위 
● 제공된 데이터의 일부 혹은 전부를 Upstage Education 프로젝트/실습 수행 이외의 목적으로 사용하는 행위위 
3 목표: CI / CD 과정 이해하기 배포:자동화 
목차 
CI/CD 
- github action 구조와 현업 배포 구조 
유닛 테스트 
배포를 위한 AWS 작업 

4 CI/CD 08 - 01 
CI에서 빌드 검증이 필요한 이유 

5 Github action 전체 흐름 배포:자동화 
https://medium.com/@armond10holman/a-guide-to-setting-up-ci-cd-pipelines-with-github-actions-d7fc98e78a87 전체 배포 ‒ 협업 과정 

6 빌드 검증이 필요한 이유 
만약 코드가 잘못 되었다면? 
지금까지는 작업이 완료되면 배포 서버에서 바로 작동 
배포 서버에서 에러가 발생, 기존 서버가 꺼진 후 
재시작 시 에러가 난다면 서버 장애 
PR 하나가 전체 시스템을 깨뜨릴 수도 있다 
 
배포:자동화 
7 CI: 지속적 통합 (Continuous Integration) 배포:자동화 
CI는 코드의 건강검진이다 
배포 자동화 툴 내에서 아래 사항들을 진행 
•Lint 검사 
•타입 검사 (mypy) 
•유닛 테스트 
•패키지 빌드 검증 
•빌드 후 빌드 결과물 저장소에 업로드 → 버전 관리/롤백 

8 Github action 구성 요소 배포:자동화 
https://tech.ktcloud.com/entry/What-is-DevOps-Github-Action GitHub가 제공하는 자동화 플랫폼 
Action 
Github Actions Workﬂow의 개별 작업 단위 
Runner 
 Action을 실행하는 컴퓨팅 리소스 
- Github Hosted Runner 
- Self Hosted Runner 
Package 
프로젝트 Build 결과물을 저장하고 배포 
빌드 버전 

9 CD: 지속적 배포 (Continuous Delivery / Deployment) 배포:자동화 
빌드를 배포에 전달/릴리즈 
검증된 코드를 자동으로 배포하는 과정 
•스테이징/프로덕션 배포 
•수동 승인 
•롤백 전략 
•”

10 유닛 테스트 08 - 02 
유닛 테스트와 자동화 
pytest 

11 유닛 테스트 필요성 배포:자동화 
가장 작은 단위의 기능을 검증하는 테스트 
코드 변경이 많아질수록 "안전망"이 필요하다 
기능을 추가하거나 수정할 때 다른 부분이 깨지는 것을 잡아줌 
"어제까지 잘 됐는데 오늘은 왜 안 돼?" → 테스트가 방지함 
리팩토링과 구조 개선의 자신감을 준다 
테스트가 커버하는 로직은 마음 놓고 바꿀 수 있음 
성능 개선, 코드 정리 등 장기 유지보수에 필수 
•”

12 유닛 테스트 필요성 배포:자동화 
가장 작은 단위의 기능을 검증하는 테스트 
반복적인 수동 테스트를 줄여서 개발 속도를 높여준다 
서버 켜고, 요청 보내고, 콘솔 확인하는 반복 작업을 자동화 
pytest 한 줄로 즉시 확인 가능 
팀 개발에서 품질 기준을 통일한다 
테스트가 "프로젝트의 규칙 문서" 역할 
새 팀원이 와도 기존 기능이 깨지는지 자동 확인 
•”

13 유닛 테스트란? 배포:자동화 
가장 작은 단위의 기능을 검증하는 테스트 
•”
비즈니스 규칙/계산/검증 로직 등 핵심 로직을 독립적으로 테스트 
데이터베이스 / 네트워크 / UI와 같은 외부 요소는 제거하고 테스트함 
실패 시 바로 피드백 → 오류 위치와 기대 값이 자동 표시 
테스트 실패 메시지가 "디버깅 가이드" 역할 
테스트 코드를 만드는 이유 
● 코드를 마음 놓고 고치기 
● 의존성을 분리하게 만드는 설계 압박 
○ 테스트하기 좋은 코드 = 좋은 설계 
● 이 코드가 뭘 책임지는지 명확해짐 

14 pytest 배포:자동화 
파이썬 테스트 실행기이자 테스트 작성 프레임워크 
문법이 간결, 설정할 게 거의 없음 
assert 하나로 유닛 테스트 작성 가능 
파일 이름 규칙: test_*.py 또는 *_test.py 파일을 테스트 파일로 인식 
함수 이름 규칙: test_로 시작하는 함수가 테스트로 인식 
•”

15 (실습) pytest 로 유닛테스트 만들기 배포:자동화 
간단한 pytest 작성하기 + 디버깅하기 
assert를 통한 검증  
•”
git switch deploy/unittest-mock 
git pull 
uv sync 
테스트  실행
  pytest tests/test_easy.py 

16 (실습) pytest 로 유닛테스트 만들기 배포:자동화 
의존성이 있는 객체 pytest 작성하기 + 디버깅하기 
assert를 통한 검증  
•”
git switch deploy/unittest-mock 
git pull 
uv sync 
테스트  실행
  pytest tests/test_user_repository.py 

17 의존성과 mock 을 통한 외부 의존성 끊기 배포:자동화 
Mock은 진짜 객체 대신 "가짜 객체"를 넣어서 테스트하는 기술 
정말 테스트할 대상 객체만 다룰 수 있다. 
테스트에서 우리가 알고 싶은 것 = "이 함수가 어떤 행동을 했는가?" 
테스트 때 실제로 저장되었나? X 
→ repository.save 가 호출되면 된다 
Mock 객체 전용 행동 검증 메서드 
해당 함수가 테스트 과정에서 호출이 되었나 
외부 시스템 호출을 가짜로 대체해, 단위 테스트를 빠르고 안정적으로 만드는 기법 
•”

18 (실습) mock pytest 로 유닛테스트 만들기 배포:자동화 
실습 순서 
1. tests/test_user_service.py 
TestUserService 생성 
2. setup_method 에서 UserRepository 를 mock 으로 선언 
     service 생성 시 mock_repo를 넘겨서 service 를 생성 
•”
git switch deploy/unittest-mock 
git pull 
uv sync 
테스트  실행
  pytest tests/test_user_service.py 
19 (실습) mock pytest 로 유닛테스트 만들기 배포:자동화 
실습 순서 
3. 테스트 시 mock_repo 함수를 호출할 때 실행하는 대신 반환할 값을 설정 
4. 테스트 진행(디버깅)으로 실제 실행하는 대신 값만 반환되는지 확인 
5.테스트 결과 확인 
•”
git switch deploy/unittest-mock 
git pull 
uv sync 

20 배포 과정에서 유닛 테스트 필요성 배포:자동화 
유닛 테스트는 배포 전 자동 검증 단계 
배포 = 기존 코드 위에 계속해서 변경을 얹는 작업 
작은 수정이 기존 기능을 망가뜨릴 수 있음 
유닛 테스트는 "이전 기능이 아직 살아있다"는 확인 
배포 후 발견되는 버그의 비용은 훨씬 큼 
● 긴급 롤백 
● 장애 공지 
● 사용자 신뢰 하락 
유닛 테스트는가장 싸게 실패할 수 있는 단계 
•”

21 github action 에서 유닛 테스트 실행 배포:자동화 
jobs: test: 
•”
테스트 돌기 위한 최소한의 설치 
테스트 실행 git switch deploy/ci 
git pull 
uv sync 
.github/workﬂows/ci.yml 
22 github action 에서 유닛 테스트 실패시 중지 배포:자동화 
jobs: test: 
•”
테스트 돌기 위한 최소한의 설치 
테스트 실행 git switch deploy/cicd 
git pull 
uv sync 
.github/workﬂows/cicd.yml 
23 (심화) 테스트 커버리지란? 배포:자동화 
코드 경로가 실제로 검증되었는지를 측정 
커버리지는 목표가 아니라 신호(signal) 
낮은 커버리지 → 테스트되지 않은 코드 영역이 명확함 
•”
"어디까지 검증했는가"를 수치로 표현한 지표 

(실습) github action (CI) 단계에서 유닛테스트 진행 
24 배포:자동화 
•”
예시 링크
25 (참고) Elastic IP : 접근 주소 고정 08 - 03 
고정 공인 IP 
안정적인 배포 장소 
26 클라우드 컴퓨터는 빌리고 반납을 자주하게 된다 배포:자동화 
배포하는 위치가 계속 바뀐다면? 
다만 인스턴스를 껐다 키면 IP 가 바뀐다 
 
ip가 자주 바뀌게 되면 서비스가 불안정해진다 
인스턴스를 종료하고 다시 시작해도 바뀌지 않을 
고정된 IP(elastic ip) 가 필요하다 

27 (참고) Elastic IP 할당과 인스턴스 연결 배포:자동화 
실습 순서 
1. elastic ip 할당 
2. 생성된 elastic ip 우클릭 Associate Elastic IP address 
3. ec2 와 연결 

28 (실습) Elastic IP 발급 이후 배포:자동화 
(주의) 기존 IP 아닌 새로 받은 Elastic IP 로 접근해야한다 

29 주의) Elastic IP 비용 이슈 배포:자동화 
ec2 종료 후 다시 쓰지 않을 목적이면  Elastic ip 도 삭제 
실행 중인 인스턴스에 연결된 IP 주소 (Elastic IP) 한 개는 무료로 사용 가능 
하지만 두 개 이상의 Elastic IP 혹은 할당되지 않은 Elastic IP는 비용 청구된다 
주의) 
서비스 완전 종료 시 Elastic IP 도 같이 삭제 해줘야한다 

30 코드로 인프라 관리 하기 
AWS CLI 08 - 04 
Aws cli 
IaC (Infra as a Code) 

31 사람이 매번 손으로 하는 설정의 위험 
배포:자동화 
실수, 불일치, 누락 등등 
콘솔에서 하는 클릭 기반 설정의 가장 큰 단점은 일관성의 부족 
태그 누락, EC2 타입 실수, 보안 그룹 규칙 순서 변경 같은 사소한 차이가 나중에 큰 문제의 씨앗 
- 운영 환경에서만 생기는 버그 
- 개발/운영 환경이 서로 다른 모습 
- 비용 정리가 안 되고 태그가 뒤죽박죽 
- 누가 무슨 설정을 바꿨는지 추적 불가능 
"클릭은 빠르게 만들 수는 있지만, 정확하게 만들 수는 없다. " 

32 IaC: Infrastructure as Code 배포:자동화 
인프라도 코드로 관리할 수 있을까? 
인프라를 '설정'이 아니라 '코드'로 정의 
재현 가능: 같은 코드를 적용하면 어디서든 똑같은 인프라 생성 
버전 관리: Git으로 이력 추적, 이전 버전으로 되돌리기 가능 
리뷰 가능: PR로 인프라 변경도 코드 리뷰 
자동화: CI/CD 파이프라인에 인프라 변경까지 포함 가능 

33 aws cli 란? 배포:자동화 
웹 콘솔 대신 명령어(텍스트)로 aws를 조작하는 도구 
https://aws.amazon.com/ko/cli/ - 명령줄 쉘에서 명령을 사용하여 AWS 서비스와 상호 작용할 수 있는 오픈 소스 도구 
- EC2, ECR, S3, IAM 같은 AWS 리소스를  명령줄에서 직접 생성/수정/삭제 가능 
- 사람이 버튼을 누르지 않아도  스크립트나 자동화에서 동일한 작업을 반복 가능 
- 리소스 확인 및 제거 

34 (실습) aws cli 사용 방법 배포:자동화 
(실습과정) aws cli 
1. ec2 인스턴스에 aws cli role 추가 
권한이 된  ec2 내에서 cli 로 명령 가능 
실습은 이 방식으로 진행 
2. 키 발급 방식 
aws conﬁgure 으로 로컬 등에서 사용할 수 있다  
단점: aws key 노출 위험  

35 (실습) 계정에 role 이 있는지 확인 배포:자동화 
IAM → Roles → SafeRole-upstage-sesac-1 검색 

36 (실습) ec2에 role 를 추가하기 - 끝 배포:자동화 
ec2 instance 우클릭 → Security → Modify IAM Role → SafeRole-upstage-sesac-{X} 등록 

37 (실습) aws 스크립트 설치 배포:자동화 
ec2 접속 후 aws 스크립트 설치 
https://docs.aws.amazon.com/ko_kr/cli/latest/userguide/getting-started-install.html 
sudo apt install unzip 
curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip" 
unzip awscliv2.zip 
sudo ./aws/install 

38 (참고) ec2 에 role 을 등록 방법 배포:자동화 
IAM → Roles → Create Role (계정엔 해당 권한이 없습니다) 
AWS Service, ec2 선택 → policy 선택  → AmazonEC2FullAccess, AWSBillingReadOnlyAccess 선택 

39 (참고) aws access key 로 aws cli 설정 배포:자동화 
key 발급 & aws cli 설정 
aws conﬁgure 
key 발급 
1. iam users 접속
https://console.aws.amazon.com/iam/home?region=ap-southeast-2#/users 
2. 유저 선택 
3. Security credentials 
4. create access key 

40 (참고) aws access key 로 aws cli 설정 배포:자동화 
aws 설정 
4. create access key 
next → create access key 

41 (참고) aws access key 로 aws cli 설정 배포:자동화 
aws conﬁgure 
https://us-east-1.console.aws.amazon.com/iam/home?region=ap-southeast-2#/users/create 
aws conﬁgure 저장 위치 

42 (참고) aws 키 발급 과정과 aws cli 계정 세팅 배포:자동화 
aws conﬁgure 
IAM → User → Create User 
계정 키 받아오기 
https://us-east-1.console.aws.amazon.com/iam/home?region=ap-southeast-2#/users/create 

43 (참고) aws 세팅 키 발급 과정 배포:자동화 
aws conﬁgure 
IAM → User → Create User 
생성된 유저 클릭 → 계정 키 생성 → CLI 선택 생성 
https://us-east-1.console.aws.amazon.com/iam/home?region=ap-southeast-2#/users/create 

44 (참고) aws 세팅 키 발급 과정 배포:자동화 
aws conﬁgure 
IAM → User → Create User 
생성된 유저 클릭 → 계정 키 생성 → CLI 선택 생성 
키 복사 (혹은 csv 저장) 
region 은 url 의 ?region= 부분 
https://us-east-1.console.aws.amazon.com/iam/home?region=ap-southeast-2#/users/create 

45 AWS CLI 명령어 조합 08 - 05 
사용 중인 리소스 확인 
리소스 시작/종료 
비용 확인 
46 aws cli 사용법 배포:자동화 
aws <서비스> <명령어> <옵션> --파라미터 값 
aws: CLI 실행 명령 
서비스(service): ec2, s3, iam, lambda 등 
명령어(command): describe, list, get, put, create, delete 
옵션(option): --region, --proﬁle, --output 
파라미터(parameter): 인자 값들 (리소스 ID, 파일 경로 등) 

47 aws cli 자주 쓰는 명령 패턴 배포:자동화 
인스턴스 조회 
aws ec2 describe-instances 
인스턴스 시작/중지 
aws ec2 start-instances --instance-ids i-1234567890 
aws ec2 stop-instances --instance-ids i-1234567890 
새 인스턴스 생성 
aws ec2 run-instances --image-id ami-1234 --instance-type t2.micro 
사용자 생성 
aws iam create-user --user-name developer1 
정책 붙이기 
aws iam attach-user-policy \ 
  --user-name upstage \ 
  --policy-arn arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess 

48 비용 최적화를 위한 aws cli 명령어 배포:자동화 
사용중인 인스턴스 조회 
 aws ec2 describe-instances \ 
  --ﬁlters "Name=instance-state-name,Values=running" \ 
  --query "Reservations[].Instances[].{ID:InstanceId,Name:Tags[?Key=='Name']|[0].Value}" \ 
  --output table --no-cli-pager 
 
(월간) AWS 비용 확인하기  
aws ce get-cost-and-usage --time-period Start=$(date +%Y-%m-01),End=$(date 
+%Y-%m-%d) --granularity MONTHLY --metrics BlendedCost --query 
"ResultsByTime[0]. Total.BlendedCost.{Amount:Amount,Unit:Unit}" --output table 
--no-cli-pager 링크 
49 (실습) 비용 최적화를 위한 aws cli 명령어 배포:자동화 
사용중인 인스턴스 조회 
--output table --no-cli-pager 
 
(월간) AWS 비용 확인하기 ( 권한이 없음) 
링크 
50 총 정리 배포: 자동화 
github action 배포 과정에서 빌드 검증 
- CI/CD 
- 유닛 테스트와 유닛 테스트 자동화 
 
aws cli 로 코드로 인프라 관리 
- aws cli 및 등록 
- aws cli 명령어 
- aws cli 자주 쓰는 명령 모음 

www.upstage.ai © 2025 Upstage Co., Ltd. 

